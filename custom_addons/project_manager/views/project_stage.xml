<odoo>
    <record id="project_stage_view_tree" model="ir.ui.view">
        <field name="name">project stage tree</field>
        <field name="type">tree</field>
        <field name="model">project.stage</field>
        <field name="arch" type="xml">

         <tree>
                    <field name="name"/>
                    <field name="weight"/>
                    <field name="hours"/>
                    <field name="manager_id"/>
                    <field name="description"/>
                    <field name="attachment"/>
                    <field name="state" readonly="1"/>
                    <field name="show_button_manager_stage" invisible="1"/>
         </tree>
          </field>
    </record>

    <record id="project_stage_view_form" model="ir.ui.view">
        <field name="name">project stage form</field>
        <field name="model">project.stage</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <header>
                          <!-- زر الإرسال يظهر فقط لمدير المشروع عندما تكون في draft -->
                        <button name="action_submit_to_stage_manager"
                                type="object"
                                string="إرسال إلى مدير المرحلة"
                                invisible="state != 'draft'"
                                class="oe_highlight"
                                groups="project_manager.project_manager_group"/>
     <!-- زر الموافقة يظهر فقط لمدير المرحلة (المستخدم نفسه) -->
                        <button name="action_approve"
                                type="object"
                                string="اعتماد المرحلة"
                                invisible="(show_button_manager_stage == False) or (state == 'approved')"
                                class="oe_highlight"
                                groups="project_manager.stage_employee_group"/>



                    </header>
                        <field name="show_button_manager_stage" invisible="1"/>
                    <group>
                        <field name="name"/>
                        <field name="weight"/>
                        <field name="hours"/>
                        <field name="manager_id"/>
                        <field name="description"/>
                        <field name="attachment"/>
                        <field name="state" readonly="1"/>
                    </group>
       </sheet>
            </form>
        </field>
    </record>

    <record id="project_stage_action" model="ir.actions.act_window">
        <field name="name">Project Stage</field>
        <field name="res_model">project.stage</field>
        <field name='view_mode'>tree,form</field>
    </record>

    <menuitem
        id="stage_menu_item"
        name="Project Stage"
        parent="configration_menu"
        action="project_stage_action"/>

</odoo>